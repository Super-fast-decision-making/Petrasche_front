<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/nav.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <script src="https://kit.fontawesome.com/0e01622099.js" crossorigin="anonymous"></script>
    <title>Document</title>
    <!-- <script src="./static/js/urls.js"></script> -->
</head>

<body>
    <div class="wrap-nav">
        <nav class="navbar">
            <div class="logo" onclick="home()">
                <img style="width:40px;"
                    src='https://velog.velcdn.com/images/tasha_han_1234/post/59e0d749-79a1-43ca-835a-a5f3181a49df/image.png'>
                Petrasche
            </div>
            <div class="serch">
                <input name="search" id="words_for_search" type="text" placeholder="Petrasche">
                <button class="serch_button" type="button" onclick="search(this)">검색</button>
            </div>
            <div class="user_infos">
                <div onclick="DM()" id="dm" class="dm">
                    <img id='n_profile_pic'
                        src="https://image.shutterstock.com/z/stock-vector-animal-dog-paw-print-isolated-silhouette-vector-illustration-1499728328.jpg"
                        alt="">
                </div>
                <div onclick="UserPage()" id="user_profile" class="user_profile">
                    <img id='user_img'
                        src="https://mblogthumb-phinf.pstatic.net/MjAxNzEyMThfMjQ1/MDAxNTEzNjA3MTcwNTg4.f9D3x971p8iDr_ox3nOQZmp2bHHA3YEtAvWI6-Zq6aAg.1E7HSp02TKDPZwC1wdciQdKiMEEzo0TvuY0ts5OmK4Mg.PNG.ooza-/IMG_9198.PNG?type=w800" alt="">
                </div>
                <div onclick="alarm(this)" id="alarm" class="alarm">
                    <i class="fa-solid fa-bell"></i>
                    <div class="history">
                    </div>
                </div>
                <div class="user">
                    <span class="user_name" id="user">로딩중..</span>
                </div>

                <div id='loginout' onclick="Logout()" class="logout">로그인</div>

            </div>

            <div>
                <div class="serchs">
                    <input name="search" id="words_for_search" type="text" placeholder="Petrasche">
                    <button class="serch_button" type="button" onclick="search(this)">검색</button>
                </div>
            </div>
            
        </nav>

        

    </div>
    <script>
                // 로그인 했을때만 해당 유저 인포 가져온다

        const GetUserInfo = () => {
            const token = localStorage.getItem('user_access_token');
            fetch(`${backend_base_url}user/`,{
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                }
            })
            .then(res => {
                if(res.ok){
                    res.json().then(data => {
                        document.getElementById('user').innerHTML = data.username;
                        document.getElementById('user_img').src = data.profile_img;
                        document.getElementById('loginout').innerHTML = '로그아웃';
                    })
                }
                else{
                    document.getElementById('user_profile').style.display = 'none';
                    document.getElementById('user').style.display = 'none';
                    document.getElementById('loginout').innerHTML = '로그인';
                }
            })
            }
            
        
        GetUserInfo()


    </script>
</body>

</html>
